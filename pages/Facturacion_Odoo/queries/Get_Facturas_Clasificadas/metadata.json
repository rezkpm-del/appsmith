{
  "gitSyncId": "694ebec5a56d53482b864ab0_ac6728ed-08fe-4e5e-9309-514efe26bd06",
  "id": "Facturacion_Odoo_Get_Facturas_Clasificadas",
  "pluginId": "postgres-plugin",
  "pluginType": "DB",
  "unpublishedAction": {
    "actionConfiguration": {
      "body": "SELECT * FROM (\n    -- 1. SUB-CONSULTA: Calculamos la categoría\n    SELECT \n        id,\n        fecha_vencimiento,\n        cliente,\n        numero,\n        total,\n        estado_pago,\n        (CASE\n            WHEN numero LIKE '00013%' THEN 'Facturado'\n            WHEN numero LIKE '0001%' OR numero LIKE '1-%' THEN 'No Facturado'\n            ELSE 'Otros'\n        END) as categoria\n    FROM public.facturas\n    WHERE numero NOT LIKE 'STJ%'\n) AS tabla_maestra\n\n-- 2. FILTROS\nWHERE \n    -- A. Filtro de Categoría (Categoría seleccionada o TODOS)\n    (\n        {{ SelectCategoria.selectedOptionValue || 'TODOS' }} = 'TODOS'\n        OR\n        categoria = {{ SelectCategoria.selectedOptionValue || 'TODOS' }}\n    )\n\n    AND\n\n    -- B. Filtro de Sucursal (Lista de sucursales o vacío)\n    (\n        {{ SelectSucursal_Sup.selectedOptionValues.length === 0 }} \n        OR \n        cliente IN (\n            SELECT value \n            FROM json_array_elements_text(\n                array_to_json(CAST({{ SelectSucursal_Sup.selectedOptionValues }} AS text[]))\n            )\n        )\n    )\n\n    AND\n\n    -- C. FILTRO DE FECHAS (Con Traductor DD-MM-YYYY)\n    (\n        fecha_vencimiento >= TO_DATE({{ FechaDesde_Sup.formattedDate }}, 'DD-MM-YYYY')\n        AND\n        fecha_vencimiento <= TO_DATE({{ FechaHasta_Sup.formattedDate }}, 'DD-MM-YYYY')\n    )",
      "encodeParamsToggle": true,
      "paginationType": "NONE",
      "pluginSpecifiedTemplates": [
        {
          "value": true
        }
      ],
      "timeoutInMillisecond": 10000
    },
    "confirmBeforeExecute": false,
    "datasource": {
      "id": "Odoo_StockFact",
      "isAutoGenerated": false,
      "name": "Odoo_StockFact",
      "pluginId": "postgres-plugin"
    },
    "dynamicBindingPathList": [
      {
        "key": "body"
      }
    ],
    "name": "Get_Facturas_Clasificadas",
    "pageId": "Facturacion_Odoo",
    "runBehaviour": "AUTOMATIC",
    "userSetOnLoad": false
  }
}